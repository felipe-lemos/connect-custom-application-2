{"version":3,"file":"3111.redirect-to-login.9adceabe70a713c8a370.js","mappings":"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","sources":["webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/dist/get-mc-origin-fecfee07.esm.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/node_modules/uuid/dist/esm-browser/native.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/node_modules/uuid/dist/esm-browser/rng.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/node_modules/uuid/dist/esm-browser/stringify.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/node_modules/uuid/dist/esm-browser/v4.js","webpack://custom-objects/./node_modules/@commercetools-frontend/url-utils/dist/commercetools-frontend-url-utils.esm.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/dist/redirect-to-login-5e148cff.esm.js","webpack://custom-objects/./node_modules/@commercetools-frontend/application-shell/dist/redirector-54a03b75.esm.js"],"sourcesContent":["import _slicedToArray from '@babel/runtime-corejs3/helpers/esm/slicedToArray';\nimport _URL from '@babel/runtime-corejs3/core-js-stable/url';\nimport _reverseInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/reverse';\n\n/**\n * Get the \"real\" Merchant Center frontend URL to redirect the user\n * to the login page.\n * We use an explicit full URL so that if a user tries to access the\n * Custom Applications directly to its domain, it will always redirect\n * the user to the login page.\n *\n * To determine the \"real\" URL, we need to check if the current location\n * is a Merchant Center domain, or if it's a custom user domain.\n * For the latter, we can derive the URL from the Merchant Center API URL.\n *\n * A Merchant Center hostname is composed by the following parts:\n *    https://<mc-prefix>.<region>.<provider>.<ct-domain>.<tld>\n * We neeed to check if at least the first 4 parts (right-to-left) are\n * the same.\n */\nfunction getMcOrigin(mcApiUrl) {\n  var _context, _context2;\n  let actualWindow = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n  const mcApiUrlObject = new _URL(mcApiUrl);\n  const _mcApiUrlObject$hostn = _reverseInstanceProperty(_context = mcApiUrlObject.hostname.split('.')).call(_context),\n    _mcApiUrlObject$hostn2 = _slicedToArray(_mcApiUrlObject$hostn, 4),\n    tldMcApi = _mcApiUrlObject$hostn2[0],\n    ctDomainMcApi = _mcApiUrlObject$hostn2[1],\n    providerMcApi = _mcApiUrlObject$hostn2[2],\n    regionMcApi = _mcApiUrlObject$hostn2[3];\n  const _actualWindow$locatio = _reverseInstanceProperty(_context2 = actualWindow.location.hostname.split('.')).call(_context2),\n    _actualWindow$locatio2 = _slicedToArray(_actualWindow$locatio, 4),\n    tldMc = _actualWindow$locatio2[0],\n    ctDomainMc = _actualWindow$locatio2[1],\n    providerMc = _actualWindow$locatio2[2],\n    regionMc = _actualWindow$locatio2[3];\n  const isMatching = tldMcApi === tldMc && ctDomainMcApi === ctDomainMc && providerMcApi === providerMc && regionMcApi === regionMc;\n  if (isMatching) {\n    return actualWindow.location.origin;\n  }\n  return mcApiUrlObject.origin.replace('mc-api', 'mc');\n}\n\nexport { getMcOrigin as g };\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import _mapInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/map';\nimport _concatInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/concat';\n\n// NOTE: This string will be replaced on build time with the package version.\nvar version = \"22.17.0\";\n\nconst matchLeadingAndTrailingSlashes = /^\\/|\\/$/g;\nconst trimLeadingAndTrailingSlashes = url => url.replace(matchLeadingAndTrailingSlashes, '');\nconst joinPaths = function () {\n  for (var _len = arguments.length, paths = new Array(_len), _key = 0; _key < _len; _key++) {\n    paths[_key] = arguments[_key];\n  }\n  const joint = _mapInstanceProperty(paths).call(paths, path => {\n    var _context;\n    if (typeof path !== 'string') throw new Error(_concatInstanceProperty(_context = \"Expected path \\\"\".concat(path, \"\\\" to be a \\\"string\\\", but got \\\"\")).call(_context, typeof path, \"\\\"\"));\n    // Trim leading and trailing slash for each single path\n    return trimLeadingAndTrailingSlashes(path);\n  }).join('/');\n  return \"/\".concat(joint);\n};\n\nexport { joinPaths, trimLeadingAndTrailingSlashes, version };\n","import { useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { v4 } from 'uuid';\nimport { oidcStorage } from '@commercetools-frontend/application-shell-connectors';\nimport { LOGOUT_REASONS } from '@commercetools-frontend/constants';\nimport { trimLeadingAndTrailingSlashes, joinPaths } from '@commercetools-frontend/url-utils';\nimport { b as buildOidcScope, a as OIDC_RESPONSE_TYPES } from './oidc-da8526e3.esm.js';\nimport { u as useIsServedByProxy } from './use-is-served-by-proxy-77984220.esm.js';\nimport { g as getMcOrigin } from './get-mc-origin-fecfee07.esm.js';\nimport { u as useRedirector } from './redirector-54a03b75.esm.js';\nimport '@babel/runtime-corejs3/core-js-stable/instance/concat';\nimport '@babel/runtime-corejs3/core-js-stable/instance/map';\nimport '@babel/runtime-corejs3/core-js-stable/instance/for-each';\nimport '@babel/runtime-corejs3/helpers/slicedToArray';\nimport '@babel/runtime-corejs3/core-js-stable/url';\nimport '@babel/runtime-corejs3/core-js-stable/instance/reverse';\nimport '@babel/runtime-corejs3/core-js-stable/object/keys';\nimport '@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols';\nimport '@babel/runtime-corejs3/core-js-stable/instance/filter';\nimport '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor';\nimport '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors';\nimport '@babel/runtime-corejs3/core-js-stable/object/define-properties';\nimport '@babel/runtime-corejs3/core-js-stable/object/define-property';\nimport '@babel/runtime-corejs3/helpers/defineProperty';\nimport 'prop-types';\nimport 'qss';\n\nconst generateAndCacheNonceWithState = state => {\n  const nonce = v4();\n  // We store additional information within the given `nonce`\n  // to then retrieve it later when the IdP redirects back\n  // to our application. The URL will contain the `nonce` within\n  // the id_token and, once validated, we can retrieve and use\n  // the state object.\n  // https://auth0.com/docs/protocols/oauth2/oauth-state#how-to-use-the-parameter-to-restore-application-state\n  oidcStorage.setSessionState(nonce, state);\n  return nonce;\n};\nconst RedirectToLogin = () => {\n  const location = useLocation();\n  const servedByProxy = useIsServedByProxy();\n  const redirector = useRedirector();\n  useEffect(() => {\n    var _window$app$__DEVELOP;\n    if ((_window$app$__DEVELOP = window.app.__DEVELOPMENT__) !== null && _window$app$__DEVELOP !== void 0 && (_window$app$__DEVELOP = _window$app$__DEVELOP.oidc) !== null && _window$app$__DEVELOP !== void 0 && _window$app$__DEVELOP.authorizeUrl) {\n      var _window$app$__DEVELOP2, _window$app$__DEVELOP3, _window$app$__DEVELOP4, _window$app$__DEVELOP5, _window$app$__DEVELOP6;\n      // Remove the `sessionToken` from storage, so that the AppShell can initiate\n      // a new authorization flow.\n      oidcStorage.clearSession();\n\n      // We pick the project key from local storage. This assumes that the value\n      // as been previously set when the application starts up.\n      // This is necessary to allow switching projects and triggering a new login.\n      const nextProjectKey = oidcStorage.getActiveProjectKey();\n\n      // According to the OIDC spec, the `state` parameter is recommended to be sent\n      // to the authorization server to help mitigating Cross-Site Request Forgery.\n      // https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest\n      // Using `state` or `nonce` is very similar but with subtle differences.\n      // Here we follow the approach described by Auth0 on how to use both, where\n      // we generate a `nonce`, store it in session storage together with some state,\n      // and send it to the authorization server as the `state` parameter.\n      // https://auth0.com/docs/protocols/oauth2/redirect-users\n      // Additionally, we still send the `nonce` parameter as well.\n      const sessionId = generateAndCacheNonceWithState({\n        applicationId: window.app.applicationId,\n        // Store query parameters to be used after the callback redirect\n        query: {\n          redirectTo: nextProjectKey ? \"/\".concat(nextProjectKey) : '/'\n        }\n      });\n      const requestedScope = buildOidcScope({\n        projectKey: nextProjectKey !== null && nextProjectKey !== void 0 ? nextProjectKey : undefined,\n        oAuthScopes: (_window$app$__DEVELOP2 = window.app.__DEVELOPMENT__) === null || _window$app$__DEVELOP2 === void 0 || (_window$app$__DEVELOP2 = _window$app$__DEVELOP2.oidc) === null || _window$app$__DEVELOP2 === void 0 ? void 0 : _window$app$__DEVELOP2.oAuthScopes,\n        additionalOAuthScopes: (_window$app$__DEVELOP3 = window.app.__DEVELOPMENT__) === null || _window$app$__DEVELOP3 === void 0 || (_window$app$__DEVELOP3 = _window$app$__DEVELOP3.oidc) === null || _window$app$__DEVELOP3 === void 0 ? void 0 : _window$app$__DEVELOP3.additionalOAuthScopes,\n        teamId: (_window$app$__DEVELOP4 = window.app.__DEVELOPMENT__) === null || _window$app$__DEVELOP4 === void 0 || (_window$app$__DEVELOP4 = _window$app$__DEVELOP4.oidc) === null || _window$app$__DEVELOP4 === void 0 ? void 0 : _window$app$__DEVELOP4.teamId,\n        applicationId: (_window$app$__DEVELOP5 = window.app.__DEVELOPMENT__) === null || _window$app$__DEVELOP5 === void 0 || (_window$app$__DEVELOP5 = _window$app$__DEVELOP5.oidc) === null || _window$app$__DEVELOP5 === void 0 ? void 0 : _window$app$__DEVELOP5.applicationId\n      });\n\n      // Store session scopes, to be able to detect if requested scopes changed\n      // in the application config and invalidate the session.\n      // This is only valid for local development.\n      oidcStorage.setSessionScope(requestedScope);\n      redirector({\n        to: '',\n        origin: (_window$app$__DEVELOP6 = window.app.__DEVELOPMENT__) === null || _window$app$__DEVELOP6 === void 0 || (_window$app$__DEVELOP6 = _window$app$__DEVELOP6.oidc) === null || _window$app$__DEVELOP6 === void 0 ? void 0 : _window$app$__DEVELOP6.authorizeUrl,\n        location: location,\n        queryParams: {\n          reason: LOGOUT_REASONS.UNAUTHORIZED,\n          // Query parameters for OIDC-lik workflow.\n          client_id: window.app.applicationId,\n          response_type: OIDC_RESPONSE_TYPES.ID_TOKEN,\n          scope: requestedScope,\n          state: sessionId,\n          nonce: sessionId\n        }\n      });\n      return;\n    }\n    const mcOrigin = servedByProxy ? getMcOrigin(window.app.mcApiUrl) : undefined;\n    redirector({\n      to: 'login',\n      origin: mcOrigin,\n      location: location,\n      queryParams: {\n        reason: LOGOUT_REASONS.UNAUTHORIZED,\n        redirectTo: trimLeadingAndTrailingSlashes(joinPaths(window.location.origin, location.pathname))\n      }\n    });\n\n    // Only execute once!\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return null;\n};\nRedirectToLogin.displayName = 'RedirectToLogin';\n\nexport { RedirectToLogin as default };\n","import _Object$keys from '@babel/runtime-corejs3/core-js-stable/object/keys';\nimport _Object$getOwnPropertySymbols from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols';\nimport _filterInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/filter';\nimport _Object$getOwnPropertyDescriptor from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor';\nimport _forEachInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/for-each';\nimport _Object$getOwnPropertyDescriptors from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors';\nimport _Object$defineProperties from '@babel/runtime-corejs3/core-js-stable/object/define-properties';\nimport _Object$defineProperty from '@babel/runtime-corejs3/core-js-stable/object/define-property';\nimport _defineProperty from '@babel/runtime-corejs3/helpers/esm/defineProperty';\nimport _pt from 'prop-types';\nimport _URL from '@babel/runtime-corejs3/core-js-stable/url';\nimport { useCallback, useEffect } from 'react';\nimport { encode } from 'qss';\nimport { l as location } from './use-is-served-by-proxy-77984220.esm.js';\n\nfunction ownKeys(e, r) { var t = _Object$keys(e); if (_Object$getOwnPropertySymbols) { var o = _Object$getOwnPropertySymbols(e); r && (o = _filterInstanceProperty(o).call(o, function (r) { return _Object$getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var _context, _context2; var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? _forEachInstanceProperty(_context = ownKeys(Object(t), !0)).call(_context, function (r) { _defineProperty(e, r, t[r]); }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(e, _Object$getOwnPropertyDescriptors(t)) : _forEachInstanceProperty(_context2 = ownKeys(Object(t))).call(_context2, function (r) { _Object$defineProperty(e, r, _Object$getOwnPropertyDescriptor(t, r)); }); } return e; }\nconst redirectTo = targetUrl => {\n  location.replace(targetUrl);\n};\nconst useRedirector = () => {\n  const redirector = useCallback(options => {\n    var _options$origin, _options$queryParams, _enhancedLocation$que;\n    // For now the authentication service runs on the same domain as the application,\n    // even on development (using the webpack dev server).\n    const originUrl = (_options$origin = options.origin) !== null && _options$origin !== void 0 ? _options$origin : window.location.origin;\n    const enhancedLocation = options.location || {};\n    const searchQuery = _objectSpread(_objectSpread({}, (_options$queryParams = options.queryParams) !== null && _options$queryParams !== void 0 ? _options$queryParams : {}), (_enhancedLocation$que = enhancedLocation.query) !== null && _enhancedLocation$que !== void 0 ? _enhancedLocation$que : {});\n    const targetUrlObject = new _URL(originUrl);\n    targetUrlObject.pathname = options.to || targetUrlObject.pathname;\n    targetUrlObject.search = \"?\".concat(encode(searchQuery));\n    const targetUrl = targetUrlObject.toString();\n    redirectTo(targetUrl);\n  }, []);\n  return redirector;\n};\nconst Redirector = props => {\n  const redirector = useRedirector();\n  useEffect(() => {\n    redirector(props);\n    // Only execute once!\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return null;\n};\nRedirector.propTypes = {\n  to: _pt.string.isRequired,\n  origin: _pt.string,\n  queryParams: _pt.shape({\n    redirectTo: _pt.string,\n    client_id: _pt.string,\n    response_type: _pt.string,\n    scope: _pt.string,\n    state: _pt.string,\n    nonce: _pt.string\n  })\n};\nRedirector.displayName = 'Redirector';\n\nexport { Redirector as R, useRedirector as u };\n"],"names":["getMcOrigin","mcApiUrl","_context","_context2","actualWindow","arguments","length","undefined","window","mcApiUrlObject","_mcApiUrlObject$hostn","hostname","split","call","_mcApiUrlObject$hostn2","tldMcApi","ctDomainMcApi","providerMcApi","regionMcApi","_actualWindow$locatio","location","_actualWindow$locatio2","tldMc","ctDomainMc","providerMc","regionMc","origin","replace","randomUUID","crypto","bind","getRandomValues","rnds8","Uint8Array","rng","Error","byteToHex","i","push","toString","slice","unsafeStringify","arr","offset","toLowerCase","v4","options","buf","rnds","random","matchLeadingAndTrailingSlashes","trimLeadingAndTrailingSlashes","url","joinPaths","_len","paths","Array","_key","joint","path","concat","join","RedirectToLogin","servedByProxy","u","redirector","useEffect","_window$app$__DEVELOP","app","__DEVELOPMENT__","oidc","authorizeUrl","_window$app$__DEVELOP2","_window$app$__DEVELOP3","_window$app$__DEVELOP4","_window$app$__DEVELOP5","_window$app$__DEVELOP6","nextProjectKey","sessionId","state","nonce","generateAndCacheNonceWithState","applicationId","query","redirectTo","requestedScope","b","projectKey","oAuthScopes","additionalOAuthScopes","teamId","to","queryParams","reason","client_id","response_type","scope","mcOrigin","g","pathname","displayName","ownKeys","e","r","t","o","enumerable","apply","_objectSpread","Object","useRedirector","useCallback","_options$origin","_options$queryParams","_enhancedLocation$que","originUrl","enhancedLocation","searchQuery","targetUrlObject","search","targetUrl","l","Redirector","props","propTypes"],"sourceRoot":""}